Current iteration of Ryan's code
